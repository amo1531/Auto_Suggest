// Generated by CoffeeScript 1.12.7
(function() {
  var AutoSuggest;

  window.AutoSuggest = AutoSuggest = (function() {
    function AutoSuggest() {
      this.displayDetails;
      this.boxWidth = 0;
      this.countryNames = [];
      this.currentUrl = window.location.href;
      this.countryObject = {};
      this.encodedSearchTerm;
      this.i = 1;
    }

    AutoSuggest.prototype.init = function() {
      this.options = {
        url: "./json/countries.json",
        getValue: "country_name",
        list: {
          match: {
            enabled: true
          },
          onChooseEvent: function() {
            var countryname, dialingcode;
            countryname = $("#searchInput").getSelectedItemData().country_name;
            dialingcode = $("#searchInput").getSelectedItemData().dialling_code;
            console.log(countryname + " , " + dialingcode);
            this.displayDetails = '<li class="attribute" ><strong>Country Name: </strong>' + countryname + '</li><li class="value"><strong>Dialling Code: </strong>' + dialingcode + '</li>';
            return $(".Results_list").append(this.displayDetails);
          },
          onClickEvent: (function(_this) {
            return function() {
              return _this.createBoxDynamically();
            };
          })(this)
        }
      };
      $("#searchInput").easyAutocomplete(this.options);
      this.widthOnPageLoad();
      $(".Search_Button").on('click', (function(_this) {
        return function() {
          var advancedUrl;
          advancedUrl = _this.onSearchClick(_this.currentUrl, _this.countryObject);
          return console.log(advancedUrl);
        };
      })(this));
      $("#searchInput").on('keydown', (function(_this) {
        return function(e) {
          var keyCode;
          keyCode = e.keyCode || e.which;
          if (keyCode === 9) {
            e.preventDefault();
            return _this.createBoxDynamically();
          }
        };
      })(this));
      return $(".Search_cross").on("click", (function(_this) {
        return function() {
          return console.log("clicked");
        };
      })(this));
    };

    AutoSuggest.prototype.widthOnPageLoad = function() {
      $(".easy-autocomplete").css("width", "100%");
      return $("#searchInput").css("width", "100%");
    };

    AutoSuggest.prototype.createBoxDynamically = function() {
      var dynamicWidth, inputbox, latestname, searchValue, spanElement;
      searchValue = $("#searchInput").val();
      console.log(searchValue.length);
      dynamicWidth = searchValue.length * 8;
      if (searchValue.length > 24) {
        dynamicWidth = searchValue.length * 7;
      } else {
        dynamicWidth = searchValue.length * 8;
      }
      inputbox = '<input class="Search_Input DynamicInput" " type ="text" value ="' + searchValue + '"/>' + '<a class="Search_cross">Ã—</a>';
      spanElement = '<span class = "SearchSpan" style="width:' + dynamicWidth + 'px" >' + inputbox + '</span>';
      $("#searchInput").val("");
      $(".easy-autocomplete").prepend(spanElement);
      latestname = $(".DynamicInput:first").val();
      this.countryObject['name' + this.i] = latestname;
      this.i += 1;
      console.log(this.countryObject);
      return this.changeMainSearchWidth(dynamicWidth + 24);
    };

    AutoSuggest.prototype.changeMainSearchWidth = function(dynamicWidth) {
      this.boxWidth += dynamicWidth;
      if (this.boxWidth > 440) {
        $("#searchInput").css("width", "461px");
        return this.dynamicWidth = 0;
      } else {
        return $("#searchInput").css("width", "calc(100% - " + this.boxWidth + "px)");
      }
    };

    AutoSuggest.prototype.onSearchClick = function(url, obj) {
      var qs;
      qs = "";
      $.each(obj, (function(_this) {
        return function(key, value) {
          var val;
          val = obj[key];
          return qs += encodeURIComponent(key) + "=" + encodeURIComponent(val) + "&";
        };
      })(this));
      if (qs.length > 0) {
        qs = qs.substring(0, qs.length - 1);
      }
      url = url + "?" + qs;
      return url;
    };

    return AutoSuggest;

  })();

  $(document).ready(function() {
    var autoObject;
    autoObject = new AutoSuggest();
    return autoObject.init();
  });

}).call(this);
